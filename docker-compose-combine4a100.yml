version: '3.8'

services:
  app:
    build: .
    container_name: shapley-flask-app
    ports:
      - "5000:5000"
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379
      - TZ=Asia/Singapore
      - HOST_CONTAINER_LOGS_PATH=/home/renuga_k/juniarto/evyd-shapley-api-server/logs
      - HOST_CONTAINER_UPLOAD_PATH=/home/renuga_k/juniarto/evyd-shapley-api-server/uploads
      - HOST_CONTAINER_VAL_PATH=/home/renuga_k/juniarto/dataset/test
      - SHAPLEYAPP_IMAGE=halayudha/shapleyapp:v1.6
    volumes:
      - ./logs:/app/logs
      - ./uploads:/app/uploads
      - /var/run/docker.sock:/var/run/docker.sock
    networks:
      - shapley-network

  redis:
    image: redislabs/rejson:latest
    container_name: shapley-redisjson
    volumes:
      - rejson_data:/data
    networks:
      - shapley-network

volumes:
  rejson_data:

networks:
  shapley-network:
    driver: bridge
    ipam:
      config:
        - subnet: 192.168.20.0/24
          gateway: 192.168.20.1

